(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{276:function(t,s,a){"use strict";a.r(s);var n=a(5),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"_17-5-内存与性能-事件委托等-17-6模拟事件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_17-5-内存与性能-事件委托等-17-6模拟事件"}},[t._v("#")]),t._v(" 17.5 内存与性能(事件委托等)-17.6模拟事件")]),t._v(" "),a("h2",{attrs:{id:"_17-5-1-事件委托"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_17-5-1-事件委托"}},[t._v("#")]),t._v(" 17.5.1 事件委托")]),t._v(" "),a("p",[t._v('“过多的事件处理程序"的解决方案是使用 '),a("strong",[t._v("事件委托")]),t._v("，它是利用事件冒泡，将事件处理程序绑定到相对高层级的一个元素上，这样出发高层级元素的子元素时，就会通过事件冒泡进而触发，有效减少事件处理程序的绑定。")]),t._v(" "),a("p",[t._v("相比于之前技术，它的优点：")]),t._v(" "),a("ul",[a("li",[t._v("document 对象随处可用")]),t._v(" "),a("li",[t._v("节省设置页面事件处理程序的时间")]),t._v(" "),a("li",[t._v("减少页面所需内存，提升性能")])]),t._v(" "),a("h2",{attrs:{id:"_17-5-2-删除事件处理程序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_17-5-2-删除事件处理程序"}},[t._v("#")]),t._v(" 17.5.2 删除事件处理程序")]),t._v(" "),a("p",[t._v("页面中的事件处理程序越多，页面的性能会越差。事件处理程序的留存问题主要有两种：")]),t._v(" "),a("ol",[a("li",[t._v("删除带有事件处理程序的元素后，事件处理程序没有被回收")]),t._v(" "),a("li",[t._v("页面卸载残留")])]),t._v(" "),a("h3",{attrs:{id:"删除带有事件处理程序的元素"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除带有事件处理程序的元素"}},[t._v("#")]),t._v(" 删除带有事件处理程序的元素")]),t._v(" "),a("p",[t._v("例如通过 DOM 方法 "),a("code",[t._v("removeChild")]),t._v(" 、"),a("code",[t._v("replaceChild")]),t._v("，或者使用 "),a("code",[t._v("innerHTML")]),t._v("替换元素删除，都会导致其绑定的 事件处理程序 不会被垃圾回收掉。")]),t._v(" "),a("p",[t._v("解决方法： 删除元素的时候，手动清除掉事件处理程序 , 例如 "),a("code",[t._v("div.onclick=null")])]),t._v(" "),a("h3",{attrs:{id:"页面卸载残留"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#页面卸载残留"}},[t._v("#")]),t._v(" 页面卸载残留")]),t._v(" "),a("p",[t._v("17.4.1 提到的，页面卸载也会存留一部分信息在内存里，事件处理程序也是其一。")]),t._v(" "),a("p",[t._v("解决方案：")]),t._v(" "),a("ul",[a("li",[t._v("最好在 "),a("code",[t._v("onunload")]),t._v(" 事件的时候手动清掉")]),t._v(" "),a("li",[t._v("不需要回退的场景中，可以在"),a("code",[t._v("onunload")]),t._v(" 事件里设置不缓存")])]),t._v(" "),a("h2",{attrs:{id:"_17-6-模拟事件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_17-6-模拟事件"}},[t._v("#")]),t._v(" 17.6 模拟事件")]),t._v(" "),a("p",[t._v("可以通过 "),a("code",[t._v("JavaScript")]),t._v(" 触发任何事件，这些事件会被当成浏览器创建的")]),t._v(" "),a("h3",{attrs:{id:"_17-6-1-dom-事件模拟"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_17-6-1-dom-事件模拟"}},[t._v("#")]),t._v(" 17.6.1 DOM 事件模拟")]),t._v(" "),a("ol",[a("li",[t._v("首先需要通过 "),a("code",[t._v("document.createEvent")]),t._v(" 方法创建一个  "),a("code",[t._v("event")]),t._v("对象，接收一个字符串，表示具体要创建的事件类别，值是下列其一：")])]),t._v(" "),a("ul",[a("li",[t._v("UIEvents (DOM3 是 UIEvent)  用户界面事件")]),t._v(" "),a("li",[t._v("MouseEvents (DOM3 是 MouseEvent)  通用鼠标事件")]),t._v(" "),a("li",[t._v("HMTLEvents(DOM3没这个) 通用HTML事件（它已经被分散到其他事件大类里了）")])]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[a("p",[t._v("然后需要调用这个 "),a("code",[t._v("event")]),t._v("对象返回的一个初始化方法（名称和传参各不相同），后面会举例")])]),t._v(" "),a("li",[a("p",[t._v("最后，需要执行 "),a("code",[t._v("dispatchEvent")]),t._v(" 去触发，接收具体的事件参数。后面会举例")])])]),t._v(" "),a("p",[t._v("具体举个例子，例如创建并触发一个鼠标点击事件，鼠标事件的初始化方法叫 "),a("code",[t._v("initMouseEvent")]),t._v(" 接收15个参数")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" btn "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'myBtn'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" myEvent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createEvent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'MouseEvents'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nmyEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("initMouseEvent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'click'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("defaultView"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("00")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nbtn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("dispatchEvent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("myEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("p",[t._v("上述行为触发后，事件的 "),a("code",[t._v("target")]),t._v(" 会被设置成  id为"),a("code",[t._v("btn")]),t._v("的元素")]),t._v(" "),a("p",[t._v("键盘事件和其他事件同理，例如可以翻阅书中543-545页的内容（不过需要看的时候，大概率去看 MDN 了）")]),t._v(" "),a("blockquote",[a("p",[t._v("书中还提到了 自定义 DOM 事件，用法在 546 页，实在想不到应用场景，了解一下应该就够了")])])])}),[],!1,null,null,null);s.default=e.exports}}]);