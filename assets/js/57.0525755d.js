(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{282:function(e,a,o){"use strict";o.r(a);var t=o(5),s=Object(t.a)({},(function(){var e=this,a=e.$createElement,o=e._self._c||a;return o("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[o("h1",{attrs:{id:"第二十五章-客户端存储-25-1-cookie"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#第二十五章-客户端存储-25-1-cookie"}},[e._v("#")]),e._v(" 第二十五章 客户端存储 25.1 cookie")]),e._v(" "),o("h2",{attrs:{id:"_25-1-cookie"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#_25-1-cookie"}},[e._v("#")]),e._v(" 25.1 cookie")]),e._v(" "),o("p",[e._v("HTTP cookie 通常被称为 cookie，意思是小甜品、饼干，用于方便给用户操作，提升用户体验，例如存储用户的登录信息，在重复访问的时候无需重复登录。它要求服务端在响应请求的时候，发送一个 "),o("code",[e._v("set-Cookie")]),e._v(" 字段的 HTTP 头部字段，之后 HTTP 响应会设置 名为 name 值 为 value 的一个 cookie 信息，在每个请求的头部中 携带一个 "),o("code",[e._v("cookie")]),e._v(" 的字段发送回去（因为 cookie 是存储在客户端的）")]),e._v(" "),o("h3",{attrs:{id:"_25-1-1-限制"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#_25-1-1-限制"}},[e._v("#")]),e._v(" 25.1.1 限制")]),e._v(" "),o("ul",[o("li",[o("p",[e._v("cookie 是与特定域绑定的，为了不被恶意利用")])]),e._v(" "),o("li",[o("p",[e._v("内存必须控制在  4M 以内")])]),e._v(" "),o("li",[o("p",[e._v("cookie 条数有最大限制，不得超过300个 cookie，每个域不超过 20 个")]),e._v(" "),o("p",[e._v("超过上限的时候，会删除掉以前的，不同浏览器执行不同的删除选择")])])]),e._v(" "),o("h3",{attrs:{id:"_25-1-2-cookie-的构成"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#_25-1-2-cookie-的构成"}},[e._v("#")]),e._v(" 25.1.2 cookie 的构成")]),e._v(" "),o("p",[e._v("cookie 由一下参数构成：")]),e._v(" "),o("ul",[o("li",[e._v("名称")]),e._v(" "),o("li",[e._v("值")]),e._v(" "),o("li",[e._v("域，cookie 的有效域，不指定则默认指定为请 cookie 的域")]),e._v(" "),o("li",[e._v("路径，请求 URL 必须包含这个路径 才会把 cookie  发送到服务器")]),e._v(" "),o("li",[e._v("过期时间，何时删除 cookie 的时间戳，设置为过去的时间可以删除当前 cookie")]),e._v(" "),o("li",[e._v("安全标志 用 "),o("code",[e._v("secure")]),e._v(" 字段标识 SSL 协议，设置了这个字符串，则必须用 "),o("code",[e._v("https")]),e._v(" 开头的请求才会发送 cookie")])]),e._v(" "),o("div",{staticClass:"language-json line-numbers-mode"},[o("pre",{pre:!0,attrs:{class:"language-json"}},[o("code",[o("span",{pre:!0,attrs:{class:"token property"}},[e._v('"set-Cookie"')]),o("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),o("span",{pre:!0,attrs:{class:"token string"}},[e._v("\"name=value; expires=Mon, 22-Jan-07 08:10:23 GMT; domain=.wrox.com;path ='/' ; secure\"")]),e._v("\n")])]),e._v(" "),o("div",{staticClass:"line-numbers-wrapper"},[o("span",{staticClass:"line-number"},[e._v("1")]),o("br")])]),o("h2",{attrs:{id:"_25-1-3-javascript-里的-cookie"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#_25-1-3-javascript-里的-cookie"}},[e._v("#")]),e._v(" 25.1.3 JavaScript 里的 cookie")]),e._v(" "),o("p",[o("code",[e._v("JavaScript")]),e._v(" 里对于 "),o("code",[e._v("cookie")]),e._v(" 的操作 API 过于简单，导致处理 cookie 比较麻烦，只有 BOM 中的 "),o("code",[e._v("document.cookie")])]),e._v(" "),o("h3",{attrs:{id:"获取值"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#获取值"}},[e._v("#")]),e._v(" 获取值")]),e._v(" "),o("p",[o("code",[e._v("document.cookie")]),e._v(" 会返回包含页面中所有有效 "),o("code",[e._v("cookie")]),e._v(" 的字符串（根据域、路径、过期时间和安全设置)，用分号隔开，例如：")]),e._v(" "),o("div",{staticClass:"language-js line-numbers-mode"},[o("pre",{pre:!0,attrs:{class:"language-js"}},[o("code",[e._v("name"),o("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("value1"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("name2"),o("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("value2"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("name3"),o("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("value3"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])]),e._v(" "),o("div",{staticClass:"line-numbers-wrapper"},[o("span",{staticClass:"line-number"},[e._v("1")]),o("br")])]),o("p",[e._v("所有名和值都是用 URL 编码的，因此需要用 "),o("code",[e._v("decodeURLComponent()")]),e._v(" 解码访问")]),e._v(" "),o("h3",{attrs:{id:"设置值"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#设置值"}},[e._v("#")]),e._v(" 设置值")]),e._v(" "),o("p",[e._v("可以通过设置 "),o("code",[e._v("document.cookie")]),e._v(" 来达到设置 "),o("code",[e._v("cookie")]),e._v(" 的目的，设置的格式和 "),o("code",[e._v("set-Cookie")]),e._v(" 的格式是一样的，传参只有名和值是必须的，参数最好使用 "),o("code",[e._v("decodeULRComponent")]),e._v("  进行编码，如果通过这种方式设置一个之前相同名称的 cookie ，不会覆盖，会创建一条新的上去，除非传参与 "),o("code",[e._v("set-Cookie")]),e._v(" 格式的传参全部都一样")]),e._v(" "),o("h3",{attrs:{id:"更新值"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#更新值"}},[e._v("#")]),e._v(" 更新值")]),e._v(" "),o("p",[e._v("设置一个之前相同名称的 cookie ，并且 路径、域和安全选项等全都一样，仅更改值，可以做到更新值")]),e._v(" "),o("h3",{attrs:{id:"删除值"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#删除值"}},[e._v("#")]),e._v(" 删除值")]),e._v(" "),o("p",[e._v("没有直接删除的方法，删除的时候，需要设置一个之前相同名称的 cookie ，并且 路径、域和安全选项等全都一样，值设置为空，"),o("code",[e._v("expires")]),e._v(" 设置成一个过去的时间戳，一般是（ new Date(0) ），过期后，达到自动删除的目的")]),e._v(" "),o("h2",{attrs:{id:"_25-1-4"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#_25-1-4"}},[e._v("#")]),e._v(" 25.1.4")]),e._v(" "),o("h3",{attrs:{id:"子-cookie"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#子-cookie"}},[e._v("#")]),e._v(" 子 cookie")]),e._v(" "),o("p",[e._v("就是在单个 cookie 中通过以下这种格式存值：")]),e._v(" "),o("div",{staticClass:"language- line-numbers-mode"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v("name=value1&name2=value2&name3=value3;\n")])]),e._v(" "),o("div",{staticClass:"line-numbers-wrapper"},[o("span",{staticClass:"line-number"},[e._v("1")]),o("br")])]),o("p",[e._v("非常像 URL 的 查询字符串格式，查询方法也类似，就不多展开了")]),e._v(" "),o("p",[e._v("更新不太方便，书中没提，应该是删了再增吧，不过 JavaScript 更新 cookie 的操作场景应该不多，子 cookie 就更别提了")]),e._v(" "),o("p",[e._v("删除同上节提到的方式")])])}),[],!1,null,null,null);a.default=s.exports}}]);